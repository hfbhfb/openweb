<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>mysql语句优化 | 工作笔记</title>
    <meta name="generator" content="VuePress 1.5.2">
    <link rel="icon" href="/img/favicon.ico">
    <meta name="description" content="管理好涉及到的知识,让自己逐步更具有效率">
    <meta name="keywords" content="管理好涉及到的知识,让自己逐步更具有效率 golang gorm kafka redis js vue echats">
    <meta name="baidu-site-verification" content="">
    <meta name="theme-color" content="#11a8cd">
    <link rel="preload" href="/assets/css/0.styles.7a226cbe.css" as="style"><link rel="preload" href="/assets/js/app.1447d235.js" as="script"><link rel="preload" href="/assets/js/2.2a228d1d.js" as="script"><link rel="preload" href="/assets/js/4.8e79b234.js" as="script"><link rel="preload" href="/assets/js/165.d25373fa.js" as="script"><link rel="prefetch" href="/assets/js/10.01788afa.js"><link rel="prefetch" href="/assets/js/100.6bb0a9c8.js"><link rel="prefetch" href="/assets/js/101.e81f68b0.js"><link rel="prefetch" href="/assets/js/102.df2ede6d.js"><link rel="prefetch" href="/assets/js/103.109d966d.js"><link rel="prefetch" href="/assets/js/104.0a52f8cd.js"><link rel="prefetch" href="/assets/js/105.4010afbe.js"><link rel="prefetch" href="/assets/js/106.e4c766c5.js"><link rel="prefetch" href="/assets/js/107.4b784af0.js"><link rel="prefetch" href="/assets/js/108.7b551c15.js"><link rel="prefetch" href="/assets/js/109.7f8067ee.js"><link rel="prefetch" href="/assets/js/11.e343e48e.js"><link rel="prefetch" href="/assets/js/110.d45130eb.js"><link rel="prefetch" href="/assets/js/111.aad4171d.js"><link rel="prefetch" href="/assets/js/112.3c36a29a.js"><link rel="prefetch" href="/assets/js/113.5a77d368.js"><link rel="prefetch" href="/assets/js/114.580c48aa.js"><link rel="prefetch" href="/assets/js/115.84c27821.js"><link rel="prefetch" href="/assets/js/116.f19ea104.js"><link rel="prefetch" href="/assets/js/117.0a180c24.js"><link rel="prefetch" href="/assets/js/118.d8411a03.js"><link rel="prefetch" href="/assets/js/119.cc111e86.js"><link rel="prefetch" href="/assets/js/12.7fe3f49e.js"><link rel="prefetch" href="/assets/js/120.ebd91687.js"><link rel="prefetch" href="/assets/js/121.80e36d0f.js"><link rel="prefetch" href="/assets/js/122.71ebb220.js"><link rel="prefetch" href="/assets/js/123.12e030eb.js"><link rel="prefetch" href="/assets/js/124.0f1e0154.js"><link rel="prefetch" href="/assets/js/125.31b9013b.js"><link rel="prefetch" href="/assets/js/126.1eee90d8.js"><link rel="prefetch" href="/assets/js/127.f0d1c26d.js"><link rel="prefetch" href="/assets/js/128.532fa158.js"><link rel="prefetch" href="/assets/js/129.600757e6.js"><link rel="prefetch" href="/assets/js/13.b1ec09fd.js"><link rel="prefetch" href="/assets/js/130.504e0d77.js"><link rel="prefetch" href="/assets/js/131.72d44a4d.js"><link rel="prefetch" href="/assets/js/132.6ec7f12f.js"><link rel="prefetch" href="/assets/js/133.04b6b303.js"><link rel="prefetch" href="/assets/js/134.84233e12.js"><link rel="prefetch" href="/assets/js/135.e80c9920.js"><link rel="prefetch" href="/assets/js/136.751d772e.js"><link rel="prefetch" href="/assets/js/137.4fe8d647.js"><link rel="prefetch" href="/assets/js/138.5555a9d4.js"><link rel="prefetch" href="/assets/js/139.a48cc2ac.js"><link rel="prefetch" href="/assets/js/14.7d23947c.js"><link rel="prefetch" href="/assets/js/140.8ed08aa0.js"><link rel="prefetch" href="/assets/js/141.614a9aa6.js"><link rel="prefetch" href="/assets/js/142.b038bc5f.js"><link rel="prefetch" href="/assets/js/143.8e4bed13.js"><link rel="prefetch" href="/assets/js/144.f9f0c200.js"><link rel="prefetch" href="/assets/js/145.af44b45b.js"><link rel="prefetch" href="/assets/js/146.a7f38059.js"><link rel="prefetch" href="/assets/js/147.73a44729.js"><link rel="prefetch" href="/assets/js/148.fcd027c0.js"><link rel="prefetch" href="/assets/js/149.728af48c.js"><link rel="prefetch" href="/assets/js/15.3e405c37.js"><link rel="prefetch" href="/assets/js/150.ef8d7aa3.js"><link rel="prefetch" href="/assets/js/151.16718a71.js"><link rel="prefetch" href="/assets/js/152.e42498ea.js"><link rel="prefetch" href="/assets/js/153.568939e9.js"><link rel="prefetch" href="/assets/js/154.2f4c2263.js"><link rel="prefetch" href="/assets/js/155.78f7f31c.js"><link rel="prefetch" href="/assets/js/156.b770e8ca.js"><link rel="prefetch" href="/assets/js/157.a15095d1.js"><link rel="prefetch" href="/assets/js/158.79b369dc.js"><link rel="prefetch" href="/assets/js/159.1bde32ca.js"><link rel="prefetch" href="/assets/js/16.aa3f1c7b.js"><link rel="prefetch" href="/assets/js/160.61a95786.js"><link rel="prefetch" href="/assets/js/161.0375aafb.js"><link rel="prefetch" href="/assets/js/162.88e14cf5.js"><link rel="prefetch" href="/assets/js/163.d1b61d32.js"><link rel="prefetch" href="/assets/js/164.83d9e3bf.js"><link rel="prefetch" href="/assets/js/166.ec6a4f40.js"><link rel="prefetch" href="/assets/js/167.e7e57c2f.js"><link rel="prefetch" href="/assets/js/168.b59b8c26.js"><link rel="prefetch" href="/assets/js/169.15db5aa0.js"><link rel="prefetch" href="/assets/js/17.b0b56e98.js"><link rel="prefetch" href="/assets/js/170.8087b64b.js"><link rel="prefetch" href="/assets/js/171.37c2f693.js"><link rel="prefetch" href="/assets/js/172.9a3538e7.js"><link rel="prefetch" href="/assets/js/173.e1706ed3.js"><link rel="prefetch" href="/assets/js/174.27db5e0a.js"><link rel="prefetch" href="/assets/js/175.3532eb6e.js"><link rel="prefetch" href="/assets/js/176.fc5ff8e1.js"><link rel="prefetch" href="/assets/js/177.e510e534.js"><link rel="prefetch" href="/assets/js/178.2abfbeb0.js"><link rel="prefetch" href="/assets/js/179.5d6557f4.js"><link rel="prefetch" href="/assets/js/18.76f63ab4.js"><link rel="prefetch" href="/assets/js/180.650a345c.js"><link rel="prefetch" href="/assets/js/181.90bff57d.js"><link rel="prefetch" href="/assets/js/182.76423674.js"><link rel="prefetch" href="/assets/js/183.e4bed46c.js"><link rel="prefetch" href="/assets/js/184.08b96381.js"><link rel="prefetch" href="/assets/js/185.2a2288bd.js"><link rel="prefetch" href="/assets/js/186.5cd9f78e.js"><link rel="prefetch" href="/assets/js/187.303627f1.js"><link rel="prefetch" href="/assets/js/188.cfd436e3.js"><link rel="prefetch" href="/assets/js/189.3ae7d5a2.js"><link rel="prefetch" href="/assets/js/19.c2f1b65e.js"><link rel="prefetch" href="/assets/js/190.68508ea5.js"><link rel="prefetch" href="/assets/js/191.1b2a55ff.js"><link rel="prefetch" href="/assets/js/192.26859048.js"><link rel="prefetch" href="/assets/js/193.9d138c04.js"><link rel="prefetch" href="/assets/js/194.0ca2756e.js"><link rel="prefetch" href="/assets/js/195.e2b91ec9.js"><link rel="prefetch" href="/assets/js/196.fbebfb8e.js"><link rel="prefetch" href="/assets/js/197.70b56ce8.js"><link rel="prefetch" href="/assets/js/198.dfc6e913.js"><link rel="prefetch" href="/assets/js/199.a727335e.js"><link rel="prefetch" href="/assets/js/20.ea16e3af.js"><link rel="prefetch" href="/assets/js/200.bf5b91cb.js"><link rel="prefetch" href="/assets/js/201.643d8534.js"><link rel="prefetch" href="/assets/js/202.4a80f26e.js"><link rel="prefetch" href="/assets/js/203.48d9703f.js"><link rel="prefetch" href="/assets/js/204.4d04dd4a.js"><link rel="prefetch" href="/assets/js/205.40927683.js"><link rel="prefetch" href="/assets/js/206.5584bdb9.js"><link rel="prefetch" href="/assets/js/207.135f9835.js"><link rel="prefetch" href="/assets/js/208.fdd27801.js"><link rel="prefetch" href="/assets/js/209.a7b61bfb.js"><link rel="prefetch" href="/assets/js/21.38de8c71.js"><link rel="prefetch" href="/assets/js/210.10067d4b.js"><link rel="prefetch" href="/assets/js/211.d1142d25.js"><link rel="prefetch" href="/assets/js/212.f36fff93.js"><link rel="prefetch" href="/assets/js/213.8cf00be3.js"><link rel="prefetch" href="/assets/js/214.81f5802b.js"><link rel="prefetch" href="/assets/js/215.cd363491.js"><link rel="prefetch" href="/assets/js/216.9534b900.js"><link rel="prefetch" href="/assets/js/217.a73d55be.js"><link rel="prefetch" href="/assets/js/218.a3b8bd34.js"><link rel="prefetch" href="/assets/js/219.5fa6d0a2.js"><link rel="prefetch" href="/assets/js/22.577c6fe2.js"><link rel="prefetch" href="/assets/js/220.67ad8faf.js"><link rel="prefetch" href="/assets/js/221.00569fac.js"><link rel="prefetch" href="/assets/js/222.1d4e3f57.js"><link rel="prefetch" href="/assets/js/223.6cc5e275.js"><link rel="prefetch" href="/assets/js/224.dda6bdf9.js"><link rel="prefetch" href="/assets/js/225.9c726f29.js"><link rel="prefetch" href="/assets/js/226.fdd4d807.js"><link rel="prefetch" href="/assets/js/227.ecc18e72.js"><link rel="prefetch" href="/assets/js/228.42909c98.js"><link rel="prefetch" href="/assets/js/229.c9c83257.js"><link rel="prefetch" href="/assets/js/23.364287c2.js"><link rel="prefetch" href="/assets/js/230.532ade6a.js"><link rel="prefetch" href="/assets/js/231.e12738bf.js"><link rel="prefetch" href="/assets/js/232.4968cfe0.js"><link rel="prefetch" href="/assets/js/233.789ffe61.js"><link rel="prefetch" href="/assets/js/234.dd94bfae.js"><link rel="prefetch" href="/assets/js/235.39a15d71.js"><link rel="prefetch" href="/assets/js/236.2e00be6a.js"><link rel="prefetch" href="/assets/js/237.1c053a36.js"><link rel="prefetch" href="/assets/js/238.993d005c.js"><link rel="prefetch" href="/assets/js/239.b9b91755.js"><link rel="prefetch" href="/assets/js/24.3bca5b55.js"><link rel="prefetch" href="/assets/js/240.e9f0110d.js"><link rel="prefetch" href="/assets/js/241.1ffb9ba0.js"><link rel="prefetch" href="/assets/js/242.4fe6903c.js"><link rel="prefetch" href="/assets/js/243.3286011d.js"><link rel="prefetch" href="/assets/js/244.36de185e.js"><link rel="prefetch" href="/assets/js/245.93a4fcb3.js"><link rel="prefetch" href="/assets/js/246.1a1781bd.js"><link rel="prefetch" href="/assets/js/247.b65e78f5.js"><link rel="prefetch" href="/assets/js/248.8fa3772c.js"><link rel="prefetch" href="/assets/js/249.de88fce6.js"><link rel="prefetch" href="/assets/js/25.533263e3.js"><link rel="prefetch" href="/assets/js/250.43c2b6d8.js"><link rel="prefetch" href="/assets/js/251.75d6b877.js"><link rel="prefetch" href="/assets/js/252.81745700.js"><link rel="prefetch" href="/assets/js/253.2622a37c.js"><link rel="prefetch" href="/assets/js/254.bdd43f64.js"><link rel="prefetch" href="/assets/js/255.ae3898a2.js"><link rel="prefetch" href="/assets/js/256.8d6c8ac5.js"><link rel="prefetch" href="/assets/js/257.75cb5a02.js"><link rel="prefetch" href="/assets/js/258.d18a5691.js"><link rel="prefetch" href="/assets/js/259.1cd7f899.js"><link rel="prefetch" href="/assets/js/26.54ae8544.js"><link rel="prefetch" href="/assets/js/260.fb63e1ce.js"><link rel="prefetch" href="/assets/js/261.29f71874.js"><link rel="prefetch" href="/assets/js/262.d0e3d58f.js"><link rel="prefetch" href="/assets/js/263.58364495.js"><link rel="prefetch" href="/assets/js/264.15a921a7.js"><link rel="prefetch" href="/assets/js/265.387fd4cf.js"><link rel="prefetch" href="/assets/js/266.cbfaba07.js"><link rel="prefetch" href="/assets/js/267.49942558.js"><link rel="prefetch" href="/assets/js/268.682c60fb.js"><link rel="prefetch" href="/assets/js/269.cc7e41bd.js"><link rel="prefetch" href="/assets/js/27.cebe8ca8.js"><link rel="prefetch" href="/assets/js/270.88833f35.js"><link rel="prefetch" href="/assets/js/271.486a7f72.js"><link rel="prefetch" href="/assets/js/272.2fcecc0b.js"><link rel="prefetch" href="/assets/js/273.df067bcd.js"><link rel="prefetch" href="/assets/js/274.53f95454.js"><link rel="prefetch" href="/assets/js/275.db8ddda0.js"><link rel="prefetch" href="/assets/js/276.621b8d5a.js"><link rel="prefetch" href="/assets/js/277.59d69f35.js"><link rel="prefetch" href="/assets/js/278.3ef3de23.js"><link rel="prefetch" href="/assets/js/279.87447c41.js"><link rel="prefetch" href="/assets/js/28.e66a3601.js"><link rel="prefetch" href="/assets/js/280.d17b769a.js"><link rel="prefetch" href="/assets/js/281.fe74143e.js"><link rel="prefetch" href="/assets/js/282.d6f38277.js"><link rel="prefetch" href="/assets/js/283.e98e0d31.js"><link rel="prefetch" href="/assets/js/284.d0d2f4c7.js"><link rel="prefetch" href="/assets/js/285.7f388224.js"><link rel="prefetch" href="/assets/js/286.53a608b5.js"><link rel="prefetch" href="/assets/js/287.b01be793.js"><link rel="prefetch" href="/assets/js/288.68b3f4fc.js"><link rel="prefetch" href="/assets/js/289.e50b9e40.js"><link rel="prefetch" href="/assets/js/29.d475201a.js"><link rel="prefetch" href="/assets/js/290.52b5bec0.js"><link rel="prefetch" href="/assets/js/291.71479a07.js"><link rel="prefetch" href="/assets/js/292.b17a104a.js"><link rel="prefetch" href="/assets/js/293.6ebd8b18.js"><link rel="prefetch" href="/assets/js/294.16a18d03.js"><link rel="prefetch" href="/assets/js/295.10901216.js"><link rel="prefetch" href="/assets/js/296.4ebfc6dc.js"><link rel="prefetch" href="/assets/js/297.4aea22fd.js"><link rel="prefetch" href="/assets/js/298.8aa80ab8.js"><link rel="prefetch" href="/assets/js/299.9d1c2fb9.js"><link rel="prefetch" href="/assets/js/3.c00a7286.js"><link rel="prefetch" href="/assets/js/30.b859e868.js"><link rel="prefetch" href="/assets/js/300.1ae2a7a9.js"><link rel="prefetch" href="/assets/js/301.e548f5a9.js"><link rel="prefetch" href="/assets/js/302.d1ddc423.js"><link rel="prefetch" href="/assets/js/303.8d50fc15.js"><link rel="prefetch" href="/assets/js/304.2db059b1.js"><link rel="prefetch" href="/assets/js/305.d6d1d77c.js"><link rel="prefetch" href="/assets/js/306.8f4b40a0.js"><link rel="prefetch" href="/assets/js/307.af153d2c.js"><link rel="prefetch" href="/assets/js/308.4f242ebf.js"><link rel="prefetch" href="/assets/js/309.b99134a3.js"><link rel="prefetch" href="/assets/js/31.d2514b42.js"><link rel="prefetch" href="/assets/js/310.28b011c3.js"><link rel="prefetch" href="/assets/js/311.8a7f6996.js"><link rel="prefetch" href="/assets/js/312.98c95fa7.js"><link rel="prefetch" href="/assets/js/313.51239379.js"><link rel="prefetch" href="/assets/js/314.bc7bc580.js"><link rel="prefetch" href="/assets/js/315.2fe0126a.js"><link rel="prefetch" href="/assets/js/316.a64e3ae5.js"><link rel="prefetch" href="/assets/js/317.dea07428.js"><link rel="prefetch" href="/assets/js/318.61098731.js"><link rel="prefetch" href="/assets/js/319.ed4d08b2.js"><link rel="prefetch" href="/assets/js/32.206e864f.js"><link rel="prefetch" href="/assets/js/320.9fdf0617.js"><link rel="prefetch" href="/assets/js/321.8497715f.js"><link rel="prefetch" href="/assets/js/322.8a50e5ef.js"><link rel="prefetch" href="/assets/js/323.93539970.js"><link rel="prefetch" href="/assets/js/324.64e2418e.js"><link rel="prefetch" href="/assets/js/325.751530a3.js"><link rel="prefetch" href="/assets/js/326.6caa1c32.js"><link rel="prefetch" href="/assets/js/327.ee64661e.js"><link rel="prefetch" href="/assets/js/328.52962b6a.js"><link rel="prefetch" href="/assets/js/329.aa68c0b5.js"><link rel="prefetch" href="/assets/js/33.49939a3e.js"><link rel="prefetch" href="/assets/js/330.014f1ad8.js"><link rel="prefetch" href="/assets/js/331.95e87dd6.js"><link rel="prefetch" href="/assets/js/332.675c31c8.js"><link rel="prefetch" href="/assets/js/333.f45217eb.js"><link rel="prefetch" href="/assets/js/334.b710d8c9.js"><link rel="prefetch" href="/assets/js/335.c549da00.js"><link rel="prefetch" href="/assets/js/336.38294efb.js"><link rel="prefetch" href="/assets/js/337.49a5a24f.js"><link rel="prefetch" href="/assets/js/338.6ec07c55.js"><link rel="prefetch" href="/assets/js/339.4db95c92.js"><link rel="prefetch" href="/assets/js/34.f0d3b9a9.js"><link rel="prefetch" href="/assets/js/340.5fc7570a.js"><link rel="prefetch" href="/assets/js/341.5e0e001f.js"><link rel="prefetch" href="/assets/js/342.7961a8d7.js"><link rel="prefetch" href="/assets/js/343.bd16837c.js"><link rel="prefetch" href="/assets/js/344.7dd60d26.js"><link rel="prefetch" href="/assets/js/345.a025db53.js"><link rel="prefetch" href="/assets/js/346.5bb11109.js"><link rel="prefetch" href="/assets/js/347.6a049bbd.js"><link rel="prefetch" href="/assets/js/348.19b18bb5.js"><link rel="prefetch" href="/assets/js/349.455cf35c.js"><link rel="prefetch" href="/assets/js/35.6c9ada71.js"><link rel="prefetch" href="/assets/js/350.8f5673b5.js"><link rel="prefetch" href="/assets/js/351.74731865.js"><link rel="prefetch" href="/assets/js/352.077d50a6.js"><link rel="prefetch" href="/assets/js/353.dbef41cd.js"><link rel="prefetch" href="/assets/js/354.a77dc6b7.js"><link rel="prefetch" href="/assets/js/355.5e7573d8.js"><link rel="prefetch" href="/assets/js/356.bac07bf0.js"><link rel="prefetch" href="/assets/js/357.eae7ca63.js"><link rel="prefetch" href="/assets/js/358.b4b9613a.js"><link rel="prefetch" href="/assets/js/359.0b7c864c.js"><link rel="prefetch" href="/assets/js/36.a8bf5a58.js"><link rel="prefetch" href="/assets/js/360.a3e256ff.js"><link rel="prefetch" href="/assets/js/37.b8a6c233.js"><link rel="prefetch" href="/assets/js/38.609fe5ac.js"><link rel="prefetch" href="/assets/js/39.72d6ac1b.js"><link rel="prefetch" href="/assets/js/40.667dc865.js"><link rel="prefetch" href="/assets/js/41.d29b6d8e.js"><link rel="prefetch" href="/assets/js/42.0643e0d8.js"><link rel="prefetch" href="/assets/js/43.d32a6c37.js"><link rel="prefetch" href="/assets/js/44.b747d44c.js"><link rel="prefetch" href="/assets/js/45.faeb0d5d.js"><link rel="prefetch" href="/assets/js/46.7e73dc6e.js"><link rel="prefetch" href="/assets/js/47.694d2483.js"><link rel="prefetch" href="/assets/js/48.03584a9f.js"><link rel="prefetch" href="/assets/js/49.7f8fd9bb.js"><link rel="prefetch" href="/assets/js/5.aa4b8737.js"><link rel="prefetch" href="/assets/js/50.a7ad02cb.js"><link rel="prefetch" href="/assets/js/51.622cfe30.js"><link rel="prefetch" href="/assets/js/52.8df87d40.js"><link rel="prefetch" href="/assets/js/53.5129cbb9.js"><link rel="prefetch" href="/assets/js/54.982eba78.js"><link rel="prefetch" href="/assets/js/55.ba144917.js"><link rel="prefetch" href="/assets/js/56.85ece61f.js"><link rel="prefetch" href="/assets/js/57.ef54402c.js"><link rel="prefetch" href="/assets/js/58.b30f2446.js"><link rel="prefetch" href="/assets/js/59.bd761058.js"><link rel="prefetch" href="/assets/js/6.e62f6ec7.js"><link rel="prefetch" href="/assets/js/60.18f222f5.js"><link rel="prefetch" href="/assets/js/61.fae85f55.js"><link rel="prefetch" href="/assets/js/62.792e43a6.js"><link rel="prefetch" href="/assets/js/63.c5360b4d.js"><link rel="prefetch" href="/assets/js/64.42af1636.js"><link rel="prefetch" href="/assets/js/65.0e8ddeb1.js"><link rel="prefetch" href="/assets/js/66.ab9eeb3a.js"><link rel="prefetch" href="/assets/js/67.9550fa90.js"><link rel="prefetch" href="/assets/js/68.c5ed802b.js"><link rel="prefetch" href="/assets/js/69.caed1e87.js"><link rel="prefetch" href="/assets/js/7.0bdfa47a.js"><link rel="prefetch" href="/assets/js/70.a34aa12d.js"><link rel="prefetch" href="/assets/js/71.3bbd0c99.js"><link rel="prefetch" href="/assets/js/72.dd2949b9.js"><link rel="prefetch" href="/assets/js/73.ca250832.js"><link rel="prefetch" href="/assets/js/74.6b649926.js"><link rel="prefetch" href="/assets/js/75.086217dc.js"><link rel="prefetch" href="/assets/js/76.a4c91bbb.js"><link rel="prefetch" href="/assets/js/77.812d4eb3.js"><link rel="prefetch" href="/assets/js/78.31354230.js"><link rel="prefetch" href="/assets/js/79.07a3799c.js"><link rel="prefetch" href="/assets/js/8.fdd6c0cc.js"><link rel="prefetch" href="/assets/js/80.b856e615.js"><link rel="prefetch" href="/assets/js/81.0c983df0.js"><link rel="prefetch" href="/assets/js/82.74a072a6.js"><link rel="prefetch" href="/assets/js/83.fbe583e9.js"><link rel="prefetch" href="/assets/js/84.b1567d37.js"><link rel="prefetch" href="/assets/js/85.9f815500.js"><link rel="prefetch" href="/assets/js/86.61923b1b.js"><link rel="prefetch" href="/assets/js/87.0d3850f5.js"><link rel="prefetch" href="/assets/js/88.56fb6991.js"><link rel="prefetch" href="/assets/js/89.2edcc464.js"><link rel="prefetch" href="/assets/js/9.362fb8cc.js"><link rel="prefetch" href="/assets/js/90.855f9d9b.js"><link rel="prefetch" href="/assets/js/91.41afa8c2.js"><link rel="prefetch" href="/assets/js/92.6c8271b0.js"><link rel="prefetch" href="/assets/js/93.d0fd9ff1.js"><link rel="prefetch" href="/assets/js/94.807ec271.js"><link rel="prefetch" href="/assets/js/95.55cc8e6c.js"><link rel="prefetch" href="/assets/js/96.0ee76c03.js"><link rel="prefetch" href="/assets/js/97.4fe7375b.js"><link rel="prefetch" href="/assets/js/98.05c63d21.js"><link rel="prefetch" href="/assets/js/99.ee008fe2.js">
    <link rel="stylesheet" href="/assets/css/0.styles.7a226cbe.css">
  </head>
  <body class="theme-mode-light">
    <div id="app" data-server-rendered="true"><div class="theme-container sidebar-open have-rightmenu"><header class="navbar blur"><div title="目录" class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/img/EB-logo.png" alt="工作笔记" class="logo"> <span class="site-name can-hide">工作笔记</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><a href="/k8s/" class="nav-link">k8s</a></div><div class="nav-item"><a href="/web/" class="nav-link">前端</a></div><div class="nav-item"><a href="/back/" class="nav-link">后台</a></div><div class="nav-item"><a href="/project/" class="nav-link">按项目</a></div><div class="nav-item"><a href="/other/" class="nav-link">其它</a></div><div class="nav-item"><a href="/manage/" class="nav-link">运维</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar" style="display:none;"><div class="blogger"><img src="img/bg.jpeg"> <div class="blogger-info"><h3>发hefabao</h3> <span>分享 终身学习 热爱生活</span></div></div> <nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><a href="/k8s/" class="nav-link">k8s</a></div><div class="nav-item"><a href="/web/" class="nav-link">前端</a></div><div class="nav-item"><a href="/back/" class="nav-link">后台</a></div><div class="nav-item"><a href="/project/" class="nav-link">按项目</a></div><div class="nav-item"><a href="/other/" class="nav-link">其它</a></div><div class="nav-item"><a href="/manage/" class="nav-link">运维</a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>应用场景</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>golang</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>gorm</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Kafka</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>mysql</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/pages/e27cea/" class="sidebar-link">《高性能MySQL(第3版)》中文PDF</a></li><li><a href="/pages/akdsf49428/" class="sidebar-link">sqlite34道题</a></li><li><a href="/pages/c86443/" class="sidebar-link">mysql练习题</a></li><li><a href="/pages/a71853/" class="sidebar-link">mysql环境docker化</a></li><li><a href="/pages/279915/" class="sidebar-link">ubuntu彻底删除mysql</a></li><li><a href="/pages/a5873a/" aria-current="page" class="active sidebar-link">mysql语句优化</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/pages/234f06/" class="sidebar-link">官方test_db数据库employee</a></li><li><a href="/pages/d22a3e/" class="sidebar-link">mysql涉及到的概念acid和crud</a></li><li><a href="/pages/31ff47/" class="sidebar-link">CAP概念在分布式</a></li><li><a href="/pages/68d64a/" class="sidebar-link">从源码编译mysql</a></li><li><a href="/pages/a46e2e/" class="sidebar-link">mysql源码分析</a></li><li><a href="/pages/ef9536/" class="sidebar-link">百万mysql表格</a></li><li><a href="/pages/2cacdd/" class="sidebar-link">mysql系统学习</a></li><li><a href="/pages/38709a/" class="sidebar-link">mysql暂时打开general命令log</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>C++</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Redis</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>mongodb</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>gin</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>nodejs_express</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <div><main class="page"> <div class="theme-vdoing-wrapper "><div class="articleInfo-wrap" data-v-f5f35434><div class="articleInfo" data-v-f5f35434><ul class="breadcrumbs" data-v-f5f35434><li data-v-f5f35434><a href="/" title="首页" class="iconfont icon-home router-link-active" data-v-f5f35434></a></li> <li data-v-f5f35434><a href="/back/" title="后端-目录页" data-v-f5f35434>后端</a></li> <li data-v-f5f35434><a href="/back//#mysql" title="后端#mysql" data-v-f5f35434>mysql</a></li></ul> <div class="info" data-v-f5f35434><div title="作者" class="author iconfont icon-touxiang" data-v-f5f35434><a href="javascript:;" data-v-f5f35434>hfbhfb</a></div> <div title="创建时间" class="date iconfont icon-riqi" data-v-f5f35434><a href="javascript:;" data-v-f5f35434>2020-10-30</a></div> <!----></div></div></div> <!----> <div class="content-wrapper"><div class="right-menu-wrapper"><div class="right-menu-margin"><div class="right-menu-content"></div></div></div> <h1><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAABKFJREFUSA3tVl1oFVcQnrMbrak3QUgkya1akpJYcrUtIqW1JvFBE9LiQ5v6JmJpolbMg32rVrhgoYK0QiMY6i9Y6EMaW5D+xFJaTYItIuK2Kr3+BJNwkxBj05sQY3b3nM6cs2dv9t7NT/vQJw/sndk5M/PNzJkzewGerP+pAmy+ON8lLzUJgA8ZYxYIYZmGYRnctDaWvJJAmTtfP1pvXsBCCPP8QFcCaRkZYACgDZFO4stNIcBCajEOlmmC9XpJ9bAGCaPaPmzPl32dvLSVu3BWCTQs0XQQ6g0DYgwLIoAZbBCdW/i+781o1VVlm/410mw4h06Y7bIPHNyWDyL4FHkX03Q8SrzNhZTZriieckWt7cL6MM85YcLpsi/7O9/iXFT6MswI0DmmpkSaJ0qLxFIm3+i1THHB3zmBH3PYx9CcykcLOeQVVa7QtdxTgQgEleX2AjHYfwA+2ddV77ruGoJUbhGDI09YSNXyMpUt5ylOzxgbUmtOp7NmbNt8v3arjTBfYELmLUV+M+nSawNNAUqpT3ClJWg5I3BLT+cGW/DXNGCa6tx1aakCGEigArTn4TDIPdrXXYKCZNrHLMCOEPvHBlLQ99s9eHB7EB6NTki73CVPQ2F5MSx/uRQixfmq7rK0wYD8w8E905bnPDfwoWs/rfv93NWN/ZfvwsLIU7A09gxECyISeGJkHAau98L97tuw7NXnoPyNF8FcYGLGKsOs0mN3OEyec9esGW/ZEl945dTP34wlR2FZVQWU1q0Cw8Tr7p+hgLLNL0FPxx/Q35mA8aEUrH6nCgwEl0tn7wUiZYJnNRh6DK4UH/k0lfyrsBKdPVv/AriGIQcEDQZ65LBAGe2Rzui9Ybjz7XUppz1/uKBbyVPGkN3ZAeC6hr0x7Nr38N5+EqkoOm17xpoqR9ohQF55ERSvr4Dkr3chNfC3DMzGJlNBElW8w9nsGQvhNGIzDkXzCg8cLK951xHsFBlTJspJNi3ZFIMF2AeDV3q8DNOB+YHi6QTrChDIWDBRi5U5f+ZMfJLu3ccrqxtdxk4SKH336LFxSmkqefwU5T8fhdSdQf9IVKD6aNiwI/hnmcAZ91isYMJIaCUCx9W098+LgruikeTqzqqxKPUwqJyCPJiyemVVZBOijDGjD38Os0jOiSPL1z3SPjXNANbiNPXAdzTfukjjuknNBbyz3nwgTd3AVFqUJ5hpHlq9MveLnWwttUfoygBmvVjuikxND3znrhsELnZk7k+OjIGxeNEkomyLVta0xxn+HZhjBc4YZ/AFjHjz9u3xRZl2BN4aq9nFwWh16IrQ1aHHEd3j1+4/dB9OtH4e29A2H1DyHQRmOSfQZ1Fy7MHBTGB6J/Djq6p3OxyO2cB+4Car7v/o3GXgfAkj23+x9ID1Teoamo/SXcbvSf2PX7Vc8DdCmE1vN9di+32P9/5YR3vLnhCVGUWBjEkr3yh4H8v9CzmsbdhzOKzsJKM90iFdaTMjRPhGVsakRvOaRidljo6H6G7j+ctrJpsP+4COhDIl0La2+FS4+5mlocBaXY5QnGZysIBYoeSsl5qQzrSj/cgNrfuEzlWBfwA+EjrZyWUvpAAAAABJRU5ErkJggg==">
          mysql语句优化
        </h1> <div class="theme-vdoing-content content__default"><h3 id="前言"><a href="#前言" class="header-anchor">#</a> 前言</h3> <p>本文将结合实例demo，阐述30条有关于优化SQL的建议，多数是实际开发中总结出来的，希望对大家有帮助。</p> <h3 id="_1、查询sql尽量不要使用select-，而是select具体字段。"><a href="#_1、查询sql尽量不要使用select-，而是select具体字段。" class="header-anchor">#</a> 1、查询SQL尽量不要使用select *，而是select具体字段。</h3> <p>反例子：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>select * from employee;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>正例子：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>select id，name from employee;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>理由：</p> <ul><li>只取需要的字段，节省资源、减少网络开销。</li> <li>select * 进行查询时，很可能就不会使用到覆盖索引了，就会造成回表查询。</li></ul> <h3 id="_2、如果知道查询结果只有一条或者只要最大-最小一条记录，建议用limit-1"><a href="#_2、如果知道查询结果只有一条或者只要最大-最小一条记录，建议用limit-1" class="header-anchor">#</a> 2、如果知道查询结果只有一条或者只要最大/最小一条记录，建议用limit 1</h3> <p>假设现在有employee员工表，要找出一个名字叫jay的人.</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>CREATE TABLE `employee` (
  `id` int(11) NOT NULL,
  `name` varchar(255) DEFAULT NULL,
  `age` int(11) DEFAULT NULL,
  `date` datetime DEFAULT NULL,
  `sex` int(1) DEFAULT NULL,
  PRIMARY KEY (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>反例：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>select id，name from employee where name='jay'
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>正例</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>select id，name from employee where name='jay' limit 1;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>理由：</p> <ul><li>加上limit 1后,只要找到了对应的一条记录,就不会继续向下扫描了,效率将会大大提高。</li> <li>当然，如果name是唯一索引的话，是不必要加上limit 1了，因为limit的存在主要就是为了防止全表扫描，从而提高性能,如果一个语句本身可以预知不用全表扫描，有没有limit ，性能的差别并不大。</li></ul> <h3 id="_3、应尽量避免在where子句中使用or来连接条件"><a href="#_3、应尽量避免在where子句中使用or来连接条件" class="header-anchor">#</a> 3、应尽量避免在where子句中使用or来连接条件</h3> <p>新建一个user表，它有一个普通索引userId，表结构如下：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>CREATE TABLE `user` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `userId` int(11) NOT NULL,
  `age` int(11) NOT NULL,
  `name` varchar(255) NOT NULL,
  PRIMARY KEY (`id`),
  KEY `idx_userId` (`userId`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>假设现在需要查询userid为1或者年龄为18岁的用户，很容易有以下sql</p> <p>反例:</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>select * from user where userid=1 or age =18
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>正例：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>//使用union all 
select * from user where userid=1 
union all 
select * from user where age = 18

//或者分开两条sql写：
select * from user where userid=1
select * from user where age = 18
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>理由：</p> <ul><li>使用or可能会使索引失效，从而全表扫描。</li></ul> <blockquote><p>对于or+没有索引的age这种情况，假设它走了userId的索引，但是走到age查询条件时，它还得全表扫描，也就是需要三步过程： 全表扫描+索引扫描+合并
如果它一开始就走全表扫描，直接一遍扫描就完事。
mysql是有优化器的，处于效率与成本考虑，遇到or条件，索引可能失效，看起来也合情合理。</p></blockquote> <h3 id="_4、优化limit分页"><a href="#_4、优化limit分页" class="header-anchor">#</a> 4、优化limit分页</h3> <p>我们日常做分页需求时，一般会用 limit 实现，但是当偏移量特别大的时候，查询效率就变得低下。</p> <p>反例：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>select id，name，age from employee limit 10000，10
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>正例：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>//方案一 ：返回上次查询的最大记录(偏移量)
select id，name from employee where id&gt;10000 limit 10.

//方案二：order by + 索引
select id，name from employee order by id  limit 10000，10

//方案三：在业务允许的情况下限制页数：
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>理由：</p> <ul><li>当偏移量最大的时候，查询效率就会越低，因为Mysql并非是跳过偏移量直接去取后面的数据，而是先把偏移量+要取的条数，然后再把前面偏移量这一段的数据抛弃掉再返回的。</li> <li>如果使用优化方案一，返回上次最大查询记录（偏移量），这样可以跳过偏移量，效率提升不少。</li> <li>方案二使用order by+索引，也是可以提高查询效率的。</li> <li>方案三的话，建议跟业务讨论，有没有必要查这么后的分页啦。因为绝大多数用户都不会往后翻太多页。</li></ul> <h3 id="_5、优化你的like语句"><a href="#_5、优化你的like语句" class="header-anchor">#</a> 5、优化你的like语句</h3> <p>日常开发中，如果用到模糊关键字查询，很容易想到like，但是like很可能让你的索引失效。</p> <p>反例：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>select userId，name from user where userId like '%123';
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>正例：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>select userId，name from user where userId like '123%';
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>理由：</p> <ul><li>把%放前面，并不走索引，如下：
<img src="https://user-gold-cdn.xitu.io/2020/3/20/170f7f2739040e5b?w=1280&amp;h=330&amp;f=png&amp;s=129628" alt=""></li> <li>把% 放关键字后面，还是会走索引的。如下：
<img src="https://user-gold-cdn.xitu.io/2020/3/20/170f7f224aa3dfed?w=1280&amp;h=314&amp;f=png&amp;s=126373" alt=""></li></ul> <h3 id="_6、使用where条件限定要查询的数据，避免返回多余的行"><a href="#_6、使用where条件限定要查询的数据，避免返回多余的行" class="header-anchor">#</a> 6、使用where条件限定要查询的数据，避免返回多余的行</h3> <p>假设业务场景是这样：查询某个用户是否是会员。曾经看过老的实现代码是这样。。。</p> <p>反例：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>List&lt;Long&gt; userIds = sqlMap.queryList(&quot;select userId from user where isVip=1&quot;);
boolean isVip = userIds.contains(userId);
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>正例：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>Long userId = sqlMap.queryObject(&quot;select userId from user where userId='userId' and isVip='1' &quot;)
boolean isVip = userId！=null;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>理由：</p> <ul><li>需要什么数据，就去查什么数据，避免返回不必要的数据，节省开销。</li></ul> <h3 id="_7、尽量避免在索引列上使用mysql的内置函数"><a href="#_7、尽量避免在索引列上使用mysql的内置函数" class="header-anchor">#</a> 7、尽量避免在索引列上使用mysql的内置函数</h3> <p>业务需求：查询最近七天内登陆过的用户(假设loginTime加了索引)</p> <p>反例：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>select userId,loginTime from loginuser where Date_ADD(loginTime,Interval 7 DAY) &gt;=now();
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>正例：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>explain  select userId,loginTime from loginuser where  loginTime &gt;= Date_ADD(NOW(),INTERVAL - 7 DAY);
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>理由：</p> <ul><li>索引列上使用mysql的内置函数，索引失效</li></ul> <p><img src="https://user-gold-cdn.xitu.io/2020/3/21/170fd5f19265afa9?w=1179&amp;h=278&amp;f=png&amp;s=28534" alt=""></p> <ul><li>如果索引列不加内置函数，索引还是会走的。
<img src="https://user-gold-cdn.xitu.io/2020/3/20/170f875955e8b7c0?w=1201&amp;h=290&amp;f=png&amp;s=28564" alt=""></li></ul> <h3 id="_8、应尽量避免在-where-子句中对字段进行表达式操作，这将导致系统放弃使用索引而进行全表扫"><a href="#_8、应尽量避免在-where-子句中对字段进行表达式操作，这将导致系统放弃使用索引而进行全表扫" class="header-anchor">#</a> 8、应尽量避免在 where 子句中对字段进行表达式操作，这将导致系统放弃使用索引而进行全表扫</h3> <p>反例：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>select * from user where age-1 =10；
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>正例：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>select * from user where age =11；
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>理由：</p> <ul><li>虽然age加了索引，但是因为对它进行运算，索引直接迷路了。。。
<img src="https://user-gold-cdn.xitu.io/2020/3/20/170f85b4a47dc153?w=1280&amp;h=265&amp;f=png&amp;s=118891" alt=""></li></ul> <h3 id="_9、inner-join-、left-join、right-join，优先使用inner-join，如果是left-join，左边表结果尽量小"><a href="#_9、inner-join-、left-join、right-join，优先使用inner-join，如果是left-join，左边表结果尽量小" class="header-anchor">#</a> 9、Inner join 、left join、right join，优先使用Inner join，如果是left join，左边表结果尽量小</h3> <blockquote><ul><li>Inner join 内连接，在两张表进行连接查询时，只保留两张表中完全匹配的结果集</li> <li>left join 在两张表进行连接查询时，会返回左表所有的行，即使在右表中没有匹配的记录。</li> <li>right join 在两张表进行连接查询时，会返回右表所有的行，即使在左表中没有匹配的记录。</li></ul></blockquote> <p>都满足SQL需求的前提下，推荐优先使用Inner join（内连接），如果要使用left join，左边表数据结果尽量小，如果有条件的尽量放到左边处理。</p> <p>反例:</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>select * from tab1 t1 left join tab2 t2  on t1.size = t2.size where t1.id&gt;2;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>正例：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>select * from (select * from tab1 where id &gt;2) t1 left join tab2 t2 on t1.size = t2.size;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>理由：</p> <ul><li>如果inner join是等值连接，或许返回的行数比较少，所以性能相对会好一点。</li> <li>同理，使用了左连接，左边表数据结果尽量小，条件尽量放到左边处理，意味着返回的行数可能比较少。</li></ul> <h3 id="_10、应尽量避免在-where-子句中使用-或-操作符，否则将引擎放弃使用索引而进行全表扫描。"><a href="#_10、应尽量避免在-where-子句中使用-或-操作符，否则将引擎放弃使用索引而进行全表扫描。" class="header-anchor">#</a> 10、应尽量避免在 where 子句中使用!=或&lt;&gt;操作符，否则将引擎放弃使用索引而进行全表扫描。</h3> <p>反例：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>select age,name  from user where age &lt;&gt;18;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>正例：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>//可以考虑分开两条sql写
select age,name  from user where age &lt;18;
select age,name  from user where age &gt;18;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>理由：</p> <ul><li>使用!=和&lt;&gt;很可能会让索引失效</li></ul> <p><img src="https://user-gold-cdn.xitu.io/2020/3/21/170f8d5a32598527?w=1124&amp;h=275&amp;f=png&amp;s=23714" alt=""></p> <h3 id="_11、使用联合索引时，注意索引列的顺序，一般遵循最左匹配原则。"><a href="#_11、使用联合索引时，注意索引列的顺序，一般遵循最左匹配原则。" class="header-anchor">#</a> 11、使用联合索引时，注意索引列的顺序，一般遵循最左匹配原则。</h3> <p>表结构：（有一个联合索引idx_userid_age，userId在前，age在后）</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>CREATE TABLE `user` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `userId` int(11) NOT NULL,
  `age` int(11) DEFAULT NULL,
  `name` varchar(255) NOT NULL,
  PRIMARY KEY (`id`),
  KEY `idx_userid_age` (`userId`,`age`) USING BTREE
) ENGINE=InnoDB AUTO_INCREMENT=2 DEFAULT CHARSET=utf8;

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>反例：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>select * from user where age = 10;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><img src="https://user-gold-cdn.xitu.io/2020/3/21/170fabb3abde4936?w=1280&amp;h=179&amp;f=png&amp;s=110711" alt=""></p> <p>正例：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>//符合最左匹配原则
select * from user where userid=10 and age =10；
//符合最左匹配原则
select * from user where userid =10;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p><img src="https://user-gold-cdn.xitu.io/2020/3/21/170fda546249a690?w=1318&amp;h=289&amp;f=png&amp;s=26076" alt=""> <img src="https://user-gold-cdn.xitu.io/2020/3/21/170fabd29ed198a8?w=1352&amp;h=244&amp;f=png&amp;s=24752" alt="">
理由：</p> <ul><li>当我们创建一个联合索引的时候，如(k1,k2,k3)，相当于创建了（k1）、(k1,k2)和(k1,k2,k3)三个索引，这就是最左匹配原则。</li> <li>联合索引不满足最左原则，索引一般会失效，但是这个还跟Mysql优化器有关的。</li></ul> <h3 id="_12、对查询进行优化，应考虑在-where-及-order-by-涉及的列上建立索引，尽量避免全表扫描。"><a href="#_12、对查询进行优化，应考虑在-where-及-order-by-涉及的列上建立索引，尽量避免全表扫描。" class="header-anchor">#</a> 12、对查询进行优化，应考虑在 where 及 order by 涉及的列上建立索引，尽量避免全表扫描。</h3> <p>反例：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>select * from user where address ='深圳' order by age ;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><img src="https://user-gold-cdn.xitu.io/2020/3/21/170fac5e1650f9b4?w=1090&amp;h=275&amp;f=png&amp;s=28394" alt="">
正例：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>添加索引
alter table user add index idx_address_age (address,age)
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p><img src="https://user-gold-cdn.xitu.io/2020/3/21/170facab45b2d9a6?w=1064&amp;h=246&amp;f=png&amp;s=30933" alt=""></p> <h3 id="_13、如果插入数据过多，考虑批量插入。"><a href="#_13、如果插入数据过多，考虑批量插入。" class="header-anchor">#</a> 13、如果插入数据过多，考虑批量插入。</h3> <p>反例：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>for(User u :list){
 INSERT into user(name,age) values(#name#,#age#)   
}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>正例：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>//一次500批量插入，分批进行
insert into user(name,age) values
&lt;foreach collection=&quot;list&quot; item=&quot;item&quot; index=&quot;index&quot; separator=&quot;,&quot;&gt;
    (#{item.name},#{item.age})
&lt;/foreach&gt;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>理由：</p> <ul><li>批量插入性能好，更加省时间</li></ul> <blockquote><p>打个比喻:假如你需要搬一万块砖到楼顶,你有一个电梯,电梯一次可以放适量的砖（最多放500）,你可以选择一次运送一块砖,也可以一次运送500,你觉得哪个时间消耗大?</p></blockquote> <h3 id="_14、在适当的时候，使用覆盖索引。"><a href="#_14、在适当的时候，使用覆盖索引。" class="header-anchor">#</a> 14、在适当的时候，使用覆盖索引。</h3> <p>覆盖索引能够使得你的SQL语句不需要回表，仅仅访问索引就能够得到所有需要的数据，大大提高了查询效率。</p> <p>反例：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>// like模糊查询，不走索引了
select * from user where userid like '%123%'
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p><img src="https://user-gold-cdn.xitu.io/2020/3/21/170fb02be8584b0a?w=1137&amp;h=294&amp;f=png&amp;s=24494" alt="">
正例：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>//id为主键，那么为普通索引，即覆盖索引登场了。
select id,name from user where userid like '%123%';
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p><img src="https://user-gold-cdn.xitu.io/2020/3/21/170fafe4a0d3d5e6?w=1488&amp;h=353&amp;f=png&amp;s=30036" alt=""></p> <h3 id="_15、慎用distinct关键字"><a href="#_15、慎用distinct关键字" class="header-anchor">#</a> 15、慎用distinct关键字</h3> <p>distinct 关键字一般用来过滤重复记录，以返回不重复的记录。在查询一个字段或者很少字段的情况下使用时，给查询带来优化效果。但是在字段很多的时候使用，却会大大降低查询效率。</p> <p>反例：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>SELECT DISTINCT * from  user;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>正例：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>select DISTINCT name from user;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>理由：</p> <ul><li>带distinct的语句cpu时间和占用时间都高于不带distinct的语句。因为当查询很多字段时，如果使用distinct，数据库引擎就会对数据进行比较，过滤掉重复数据，然而这个比较，过滤的过程会占用系统资源，cpu时间。</li></ul> <h3 id="_16、删除冗余和重复索引"><a href="#_16、删除冗余和重复索引" class="header-anchor">#</a> 16、删除冗余和重复索引</h3> <p>反例：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>  KEY `idx_userId` (`userId`)  
  KEY `idx_userId_age` (`userId`,`age`)
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>正例:</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>  //删除userId索引，因为组合索引（A，B）相当于创建了（A）和（A，B）索引
  KEY `idx_userId_age` (`userId`,`age`)
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>理由：</p> <ul><li>重复的索引需要维护，并且优化器在优化查询的时候也需要逐个地进行考虑，这会影响性能的。</li></ul> <h3 id="_17、如果数据量较大，优化你的修改-删除语句。"><a href="#_17、如果数据量较大，优化你的修改-删除语句。" class="header-anchor">#</a> 17、如果数据量较大，优化你的修改/删除语句。</h3> <p>避免同时修改或删除过多数据，因为会造成cpu利用率过高，从而影响别人对数据库的访问。</p> <p>反例：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>//一次删除10万或者100万+？
delete from user where id &lt;100000;
//或者采用单一循环操作，效率低，时间漫长
for（User user：list）{
   delete from user； 
}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>正例：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>//分批进行删除,如每次500
delete user where id&lt;500
delete product where id&gt;=500 and id&lt;1000；
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>理由：</p> <ul><li>一次性删除太多数据，可能会有lock wait timeout exceed的错误，所以建议分批操作。</li></ul> <h3 id="_18、where子句中考虑使用默认值代替null。"><a href="#_18、where子句中考虑使用默认值代替null。" class="header-anchor">#</a> 18、where子句中考虑使用默认值代替null。</h3> <p>反例：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>select * from user where age is not null;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><img src="https://user-gold-cdn.xitu.io/2020/3/21/170fbaec810f084f?w=1176&amp;h=215&amp;f=png&amp;s=22551" alt="">
正例：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>//设置0为默认值
select * from user where age&gt;0;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p><img src="https://user-gold-cdn.xitu.io/2020/3/21/170fbb088234cc77?w=1190&amp;h=225&amp;f=png&amp;s=23147" alt="">
理由：</p> <ul><li>并不是说使用了is null 或者 is not null 就会不走索引了，这个跟mysql版本以及查询成本都有关。</li></ul> <blockquote><p>如果mysql优化器发现，走索引比不走索引成本还要高，肯定会放弃索引，这些条件<code>！=，&gt;is null，is not null</code>经常被认为让索引失效，其实是因为一般情况下，查询的成本高，优化器自动放弃的。</p></blockquote> <ul><li>如果把null值，换成默认值，很多时候让走索引成为可能，同时，表达意思会相对清晰一点。</li></ul> <h3 id="_19、不要有超过5个以上的表连接"><a href="#_19、不要有超过5个以上的表连接" class="header-anchor">#</a> 19、不要有超过5个以上的表连接</h3> <ul><li>连表越多，编译的时间和开销也就越大。</li> <li>把连接表拆开成较小的几个执行，可读性更高。</li> <li>如果一定需要连接很多表才能得到数据，那么意味着糟糕的设计了。</li></ul> <h3 id="_20、exist-in的合理利用"><a href="#_20、exist-in的合理利用" class="header-anchor">#</a> 20、exist &amp; in的合理利用</h3> <p>假设表A表示某企业的员工表，表B表示部门表，查询所有部门的所有员工，很容易有以下SQL:</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>select * from A where deptId in (select deptId from B);
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>这样写等价于：</p> <blockquote><p>先查询部门表B</p> <p>select deptId from B</p> <p>再由部门deptId，查询A的员工</p> <p>select * from A where A.deptId = B.deptId</p></blockquote> <p>可以抽象成这样的一个循环：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>   List&lt;&gt; resultSet ;
    for(int i=0;i&lt;B.length;i++) {
          for(int j=0;j&lt;A.length;j++) {
          if(A[i].id==B[j].id) {
             resultSet.add(A[i]);
             break;
          }
       }
    }
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>显然，除了使用in，我们也可以用exists实现一样的查询功能，如下：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>select * from A where exists (select 1 from B where A.deptId = B.deptId); 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>因为exists查询的理解就是，先执行主查询，获得数据后，再放到子查询中做条件验证，根据验证结果（true或者false），来决定主查询的数据结果是否得意保留。</p> <p>那么，这样写就等价于：</p> <blockquote><p>select * from A,先从A表做循环</p> <p>select * from B where A.deptId = B.deptId,再从B表做循环.</p></blockquote> <p>同理，可以抽象成这样一个循环：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>   List&lt;&gt; resultSet ;
    for(int i=0;i&lt;A.length;i++) {
          for(int j=0;j&lt;B.length;j++) {
          if(A[i].deptId==B[j].deptId) {
             resultSet.add(A[i]);
             break;
          }
       }
    }
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>数据库最费劲的就是跟程序链接释放。假设链接了两次，每次做上百万次的数据集查询，查完就走，这样就只做了两次；相反建立了上百万次链接，申请链接释放反复重复，这样系统就受不了了。即mysql优化原则，就是小表驱动大表，小的数据集驱动大的数据集，从而让性能更优。</p> <p>因此，我们要选择最外层循环小的，也就是，如果<strong>B的数据量小于A，适合使用in，如果B的数据量大于A，即适合选择exist</strong>。</p> <h3 id="_21、尽量用-union-all-替换-union"><a href="#_21、尽量用-union-all-替换-union" class="header-anchor">#</a> 21、尽量用 union all 替换 union</h3> <p>如果检索结果中不会有重复的记录，推荐union all 替换 union。</p> <p>反例：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>select * from user where userid=1 
union  
select * from user where age = 10
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>正例：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>select * from user where userid=1 
union all  
select * from user where age = 10
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>理由：</p> <ul><li>如果使用union，不管检索结果有没有重复，都会尝试进行合并，然后在输出最终结果前进行排序。如果已知检索结果没有重复记录，使用union all 代替union，这样会提高效率。</li></ul> <h3 id="_22、索引不宜太多，一般5个以内。"><a href="#_22、索引不宜太多，一般5个以内。" class="header-anchor">#</a> 22、索引不宜太多，一般5个以内。</h3> <ul><li>索引并不是越多越好，索引虽然提高了查询的效率，但是也降低了插入和更新的效率。</li> <li>insert或update时有可能会重建索引，所以建索引需要慎重考虑，视具体情况来定。</li> <li>一个表的索引数最好不要超过5个，若太多需要考虑一些索引是否没有存在的必要。</li></ul> <h3 id="_23、尽量使用数字型字段，若只含数值信息的字段尽量不要设计为字符型"><a href="#_23、尽量使用数字型字段，若只含数值信息的字段尽量不要设计为字符型" class="header-anchor">#</a> 23、尽量使用数字型字段，若只含数值信息的字段尽量不要设计为字符型</h3> <p>反例：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>king_id` varchar（20） NOT NULL COMMENT '守护者Id'
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>正例：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>`king_id` int(11) NOT NULL COMMENT '守护者Id'`
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>理由：</p> <ul><li>相对于数字型字段，字符型会降低查询和连接的性能，并会增加存储开销。</li></ul> <h3 id="_24、索引不适合建在有大量重复数据的字段上，如性别这类型数据库字段。"><a href="#_24、索引不适合建在有大量重复数据的字段上，如性别这类型数据库字段。" class="header-anchor">#</a> 24、索引不适合建在有大量重复数据的字段上，如性别这类型数据库字段。</h3> <p>因为SQL优化器是根据表中数据量来进行查询优化的，如果索引列有大量重复数据，Mysql查询优化器推算发现不走索引的成本更低，很可能就放弃索引了。</p> <h3 id="_25、尽量避免向客户端返回过多数据量。"><a href="#_25、尽量避免向客户端返回过多数据量。" class="header-anchor">#</a> 25、尽量避免向客户端返回过多数据量。</h3> <p>假设业务需求是，用户请求查看自己最近一年观看过的直播数据。</p> <p>反例：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>//一次性查询所有数据回来
select * from LivingInfo where watchId =useId and watchTime &gt;= Date_sub(now(),Interval 1 Y)
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>正例：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>//分页查询
select * from LivingInfo where watchId =useId and watchTime&gt;= Date_sub(now(),Interval 1 Y) limit offset，pageSize

//如果是前端分页，可以先查询前两百条记录，因为一般用户应该也不会往下翻太多页，
select * from LivingInfo where watchId =useId and watchTime&gt;= Date_sub(now(),Interval 1 Y) limit 200 ;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h3 id="_26、当在sql语句中连接多个表时-请使用表的别名，并把别名前缀于每一列上，这样语义更加清晰。"><a href="#_26、当在sql语句中连接多个表时-请使用表的别名，并把别名前缀于每一列上，这样语义更加清晰。" class="header-anchor">#</a> 26、当在SQL语句中连接多个表时,请使用表的别名，并把别名前缀于每一列上，这样语义更加清晰。</h3> <p>反例：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>select  * from A inner
join B on A.deptId = B.deptId;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>正例：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>select  memeber.name,deptment.deptName from A member inner
join B deptment on member.deptId = deptment.deptId;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h3 id="_27、尽可能使用varchar-nvarchar-代替-char-nchar。"><a href="#_27、尽可能使用varchar-nvarchar-代替-char-nchar。" class="header-anchor">#</a> 27、尽可能使用varchar/nvarchar 代替 char/nchar。</h3> <p>反例：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>  `deptName` char(100) DEFAULT NULL COMMENT '部门名称'
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>正例：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>  `deptName` varchar(100) DEFAULT NULL COMMENT '部门名称'
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>理由：</p> <ul><li>因为首先变长字段存储空间小，可以节省存储空间。</li> <li>其次对于查询来说，在一个相对较小的字段内搜索，效率更高。</li></ul> <h3 id="_28、为了提高group-by-语句的效率，可以在执行到该语句前，把不需要的记录过滤掉。"><a href="#_28、为了提高group-by-语句的效率，可以在执行到该语句前，把不需要的记录过滤掉。" class="header-anchor">#</a> 28、为了提高group by 语句的效率，可以在执行到该语句前，把不需要的记录过滤掉。</h3> <p>反例：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>select job，avg（salary） from employee  group by job having job ='president' 
or job = 'managent'
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>正例：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>select job，avg（salary） from employee where job ='president' 
or job = 'managent' group by job；
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h3 id="_29、如何字段类型是字符串，where时一定用引号括起来，否则索引失效"><a href="#_29、如何字段类型是字符串，where时一定用引号括起来，否则索引失效" class="header-anchor">#</a> 29、如何字段类型是字符串，where时一定用引号括起来，否则索引失效</h3> <p>反例：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>select * from user where userid =123;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><img src="https://user-gold-cdn.xitu.io/2020/3/21/170fd45766e57cdc?w=1280&amp;h=279&amp;f=png&amp;s=119169" alt="">
正例：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>select * from user where userid ='123';
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><img src="https://user-gold-cdn.xitu.io/2020/3/21/170fd46de786dce3?w=1280&amp;h=296&amp;f=png&amp;s=135401" alt="">
理由：</p> <ul><li>为什么第一条语句未加单引号就不走索引了呢？ 这是因为不加单引号时，是字符串跟数字的比较，它们类型不匹配，MySQL会做隐式的类型转换，把它们转换为浮点数再做比较。</li></ul> <h3 id="_30、使用explain-分析你sql的计划"><a href="#_30、使用explain-分析你sql的计划" class="header-anchor">#</a> 30、使用explain 分析你SQL的计划</h3> <p>日常开发写SQL的时候，尽量养成一个习惯吧。用explain分析一下你写的SQL，尤其是走不走索引这一块。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>explain select * from user where userid =10086 or age =18;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><img src="https://user-gold-cdn.xitu.io/2020/3/21/170fd29c57512897?w=1140&amp;h=188&amp;f=png&amp;s=22140" alt=""></p> <h3 id="参考与感谢"><a href="#参考与感谢" class="header-anchor">#</a> 参考与感谢</h3> <ul><li><a href="https://segmentfault.com/a/1190000014509559" target="_blank" rel="noopener noreferrer">Mysql优化原则_小表驱动大表IN和EXISTS的合理利用<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://www.cnblogs.com/knowledgesea/p/3686105.html" target="_blank" rel="noopener noreferrer">sql语句的优化分析<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul> <h3 id="个人公众号"><a href="#个人公众号" class="header-anchor">#</a> 个人公众号</h3> <p><img src="https://user-gold-cdn.xitu.io/2019/7/28/16c381c89b127bbb?w=344&amp;h=344&amp;f=jpeg&amp;s=8943" alt=""></p> <ul><li>觉得写得好的小伙伴给个点赞+关注啦，谢谢~</li> <li>如果有写得不正确的地方，麻烦指出，感激不尽。</li> <li>同时非常期待小伙伴们能够关注我公众号，后面慢慢推出更好的干货~嘻嘻</li> <li>github地址：https://github.com/whx123/JavaHome</li></ul></div></div> <div class="page-edit"><!----> <!----> <div class="last-updated"><span class="prefix">上次更新:</span> <span class="time">2021/11/01, 22:11:00</span></div></div> <div class="page-nav-wapper"><div class="page-nav-centre-wrap"><a href="/pages/279915/" class="page-nav-centre page-nav-centre-prev"><div class="tooltip">ubuntu彻底删除mysql</div></a> <a href="/pages/234f06/" class="page-nav-centre page-nav-centre-next"><div class="tooltip">官方test_db数据库employee</div></a></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/pages/279915/" class="prev">ubuntu彻底删除mysql</a></span> <span class="next"><a href="/pages/234f06/">官方test_db数据库employee</a>→
      </span></p></div></div></div> <!----> </main></div> <div class="buttons"><div title="返回顶部" class="button blur go-to-top iconfont icon-fanhuidingbu" style="display:none;"></div> <div title="去评论" class="button blur go-to-comment iconfont icon-pinglun" style="display:none;"></div></div></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.1447d235.js" defer></script><script src="/assets/js/2.2a228d1d.js" defer></script><script src="/assets/js/4.8e79b234.js" defer></script><script src="/assets/js/165.d25373fa.js" defer></script>
  </body>
</html>